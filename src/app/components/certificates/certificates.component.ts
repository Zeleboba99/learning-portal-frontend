import { Component, OnInit } from '@angular/core';
import * as pdfMake from 'pdfmake/build/pdfmake';
import * as pdfFonts from 'pdfmake/build/vfs_fonts';
import {Course} from '../../models/course';
import {CourseService} from '../../services/course.service';
import {ActivatedRoute, Router} from '@angular/router';
import {UserService} from '../../services/user.service';
import {AuthService} from '../../services/auth.service';
import {User} from '../../models/user';
import {NgxSpinnerService} from 'ngx-spinner';

import './../../../assets/smtp.js';
declare let Email: any;
pdfMake.vfs = pdfFonts.pdfMake.vfs;



@Component({
  selector: 'app-certificates',
  templateUrl: './certificates.component.html',
  styleUrls: ['./certificates.component.css']
})
export class CertificatesComponent implements OnInit {

  public courses: Course[] = [];
  public selectedCourse: Course = new Course('', '', null, 1);
  public user: User = new User(1, '', '', '');
  imageData: any;
  constructor(private courseService: CourseService, private router: Router, private userService: UserService,
              private spinnerService: NgxSpinnerService) { }

  ngOnInit() {
    this.spinnerService.show();
    this.courseService.getPassedCourses().subscribe(res => {
      this.courses = res;
      this.spinnerService.hide();
    });
    this.userService.getLoggedInUser().subscribe(res => this.user = res);
  }

  onOpenPdf(course: Course) {
    this.selectedCourse = course;
    const documentDefinition = this.getDocumentDefinition();
    pdfMake.createPdf(documentDefinition).open();
  }

  onDownloadPdf(course: Course) {
    this.selectedCourse = course;
    const documentDefinition = this.getDocumentDefinition();
    pdfMake.createPdf(documentDefinition).download();
  }

  getDocumentDefinition() {
    return {
      pageSize: 'LETTER',
      background: [
        {
          image: 'data:image/jpeg;base64,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',
          width: 615,
          heght: 900
        }
      ],
      content: [
        {
          text: 'CERTIFICATE',
          bold: true,
          fontSize: 20,
          alignment: 'center',
          margin: [0, 100, 0, 60]
        },
        {
          text: 'This certificate is issued to the user \n' + this.user.name + '\nand confirms the successful completion of the course\n' + this.selectedCourse.name,
          style: 'name',
          alignment: 'center',
          margin: [0, 100, 0, 60]
        },
        {
          text: 'Learning Portal',
          style: 'name',
          alignment: 'right',
          margin: [0, 150, 60, 60],
        }
      ],
      styles: {
        name: {
          fontSize: 16,
          bold: true
        }
      }
    };
  }

  onEmail(course: Course) {
    const documentDefinition = this.getDocumentDefinition();
    const pdfDocGenerator = pdfMake.createPdf(documentDefinition);
    pdfDocGenerator.getBase64((data) => {
      this.imageData = data;
      console.log(this.imageData);
      Email.send({
        Host : 'smtp.elasticemail.com',
        Username : 'katee241199@gmail.com',
        Password : '7C01D529207D9E727F3A98A1DC36C9084CB0',
        To : 'katee241199@gmail.com',
        From : 'katee241199@gmail.com',
        Subject : 'Learning portal',
        Body : '<h3>Congratulations!</h3> <i>You successfully passed the course' + course.name + '! <p>Check your <a href="https://portal-angular.herokuapp.com/certificates">certificates</a> for downloading it</p></i> <b>Name: With Love your, Learning Portal.</b>'
      }).then( message => message = '' );
    });
  }
}
